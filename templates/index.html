<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Yonexus - XP Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- LOADING OVERLAY -->
    <div id="loadingOverlay" class="loading-overlay" aria-busy="false">
        <div class="loading-box">
            <div class="spinner"></div>
            <div id="loadingText">Carregando...</div>
        </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="toast"></div>

    <!-- HEADER -->
    <header class="header">

        <div class="tracker-header">
            <div class="tracker-left">
                <h2 id="charName">Personagem</h2>
                <div id="info" class="tracker-info">Voca√ß√£o ‚Ä¢ Level ‚Ä¢ Mundo</div>
            </div>

            <div class="tracker-right">
                <button class="btn-metrics" onclick="window.location.href='/more-metrics'">
                    Mais m√©tricas
                </button>

                <button class="btn-settings" onclick="openSettings()">
                    <span>‚öô</span> Configura√ß√µes
                </button>

                <form action="{{ url_for('logout') }}" method="post" class="logout-form">
                    <button type="submit" class="btn-logout-tracker">Sair</button>
                </form>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- STATS -->
        <section class="stats-grid">
            <div class="card highlight">
                <span>XP Atual</span>
                <h2 id="xp">0</h2>
            </div>
            <div class="card">
                <span>XP Restante</span>
                <h2 id="remaining">0</h2>
            </div>
            <div class="card">
                <span>M√©dia XP/dia</span>
                <h2 id="avg">0</h2>
            </div>
            <div class="card">
                <span>Estimativa de dias</span>
                <h2 id="eta">‚Äî</h2>
            </div>
        </section>

        <!-- META DI√ÅRIA -->
        <section class="daily-goal">
            <h3 id="dailyTitle">Meta di√°ria</h3>
            <div id="goalWarning" class="extra-metrics" style="display:none;">
                <h3>Aten√ß√£o</h3>
                <p>
                    O n√≠vel atual do personagem j√° ultrapassou o n√≠vel meta configurado.
                    Considere ajustar sua meta nas configura√ß√µes.
                </p>
            </div>
            <div id="goalReached" class="extra-metrics" style="display:none;">
                <h3>Meta alcan√ßada üéâ</h3>
                <p>
                    Voc√™ atingiu ou ultrapassou a meta de XP configurada. Ajuste a meta para um novo objetivo.
                </p>
            </div>

            <div class="progress-bar">
                <div id="progressFill" class="fill"></div>
            </div>
            <p class="daily-text">
                <span id="dailyPercent">0%</span> ‚Ä¢
                <span id="dailyText">0 / 0 XP</span>
            </p>
            <p id="dailyRemaining" class="daily-remaining"></p>
        </section>

        <!-- ENTRADA DE XP -->
        <section class="entry">
            <h3>Registrar XP do dia</h3>
            <div class="entry-box">
                <input id="xpInput" type="text" placeholder="Ex: 250000" />
                <button id="xpSubmitBtn" onclick="addXP()">Adicionar</button>
            </div>
            <label class="death-toggle">
                <input id="deathToggle" type="checkbox" onchange="updateXpMode()" />
                <span class="skull">üíÄ</span>
                <span>Marcar como morte (retirar XP)</span>
            </label>
        </section>

        <!-- GR√ÅFICO -->
        <section class="chart-section">
            <h3>Hist√≥rico de XP di√°ria</h3>
            <canvas id="chart" height="120"></canvas>
        </section>

        <section class="extra-metrics">
            <h3>Detalhes adicionais</h3>
            <p>Use o hist√≥rico para entender seus melhores dias de up e ajustar sua meta di√°ria.</p>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="footer">
        <p>Yonexus ‚Ä¢ F√£ site n√£o oficial de Tibia.</p>
    </footer>

    <!-- MODAL CONFIGURA√á√ïES -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <h2>Configura√ß√µes</h2>

            <label for="cfgName">Nome do personagem</label>
            <input id="cfgName" type="text" />
            <div id="charChangeWarning" class="form-note" style="display:none;">
                Ao alterar o nome do personagem e salvar, todo o hist√≥rico de XP ser√° zerado.
            </div>

            <label for="cfgStart">XP inicial</label>
            <input id="cfgStart" type="number" />
            <div id="cfgStartNote" class="cfg-note"></div>

            <label for="cfgDaily">Meta di√°ria de XP</label>
            <input id="cfgDaily" type="number" />

            <label for="cfgGoalLevel">N√≠vel meta</label>
            <select id="cfgGoalLevel"></select>
            <div id="goalXpPreview" class="form-note"></div>

            <div class="modal-actions">
                <button type="button" onclick="resetXpHistory()">Zerar hist√≥rico</button>
                <button type="button" onclick="closeSettings()">Cancelar</button>
                <button type="button" class="save" onclick="saveSettings()">Salvar</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
